#<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="112.7mm" height="112.7mm" viewBox = " 0 0 1107.993037 753.6620369999999" >
#<g transform="translate(22.5000185, 22.5000185) " >
#<polygon style="stroke:#000000; fill:none; stroke-width:0.90000074" points="0, 0 16.8307225, 0 16.8307225, 10.62993 33.661445, 10.62993 33.661445, 0 44.291375, 0 44.291375, 10.62993 54.921305000000004, 10.62993 54.921305000000004, 0 65.55123499999999, 0 65.55123499999999, 10.62993 76.181165, 10.62993 76.181165, 0 86.811095, 0 86.811095, 10.62993 97.441025, 10.62993 97.441025, 0 108.070955, 0 108.070955, 10.62993 118.700885, 10.62993 118.700885, 0 129.330815, 0 129.330815, 10.62993 139.960745, 10.62993 139.960745, 0 150.590675, 0 150.590675, 10.62993 161.22060499999998, 10.62993 161.22060499999998, 0 171.85053499999998, 0 171.85053499999998, 10.62993 182.48046499999998, 10.62993 182.48046499999998, 0 193.11039499999998, 0 193.11039499999998, 10.62993 203.74032499999998, 10.62993 203.74032499999998, 0 214.370255, 0 214.370255, 10.62993 225.000185, 10.62993 225.000185, 0 235.630115, 0 235.630115, 10.62993 246.260045, 10.62993 246.260045, 0 256.889975, 0 256.889975, 10.62993 267.519905, 10.62993 267.519905, 0 278.149835, 0 278.149835, 10.62993 288.779765, 10.62993 288.779765, 0 299.409695, 0 299.409695, 10.62993 310.039625, 10.62993 310.039625, 0 320.669555, 0 320.669555, 10.62993 337.5002775, 10.62993 337.5002775, 0 354.331, 0 354.331, 16.8307225 343.70107, 16.8307225 343.70107, 33.661445 354.331, 33.661445 354.331, 44.291375 343.70107, 44.291375 343.70107, 54.921305000000004 354.331, 54.921305000000004 354.331, 65.55123499999999 343.70107, 65.55123499999999 343.70107, 76.181165 354.331, 76.181165 354.331, 86.811095 343.70107, 86.811095 343.70107, 97.441025 354.331, 97.441025 354.331, 108.070955 343.70107, 108.070955 343.70107, 118.700885 354.331, 118.700885 354.331, 129.330815 343.70107, 129.330815 343.70107, 139.960745 354.331, 139.960745 354.331, 150.590675 343.70107, 150.590675 343.70107, 161.22060499999998 354.331, 161.22060499999998 354.331, 171.85053499999998 343.70107, 171.85053499999998 343.70107, 182.48046499999998 354.331, 182.48046499999998 354.331, 193.11039499999998 343.70107, 193.11039499999998 343.70107, 203.74032499999998 354.331, 203.74032499999998 354.331, 214.370255 343.70107, 214.370255 343.70107, 225.000185 354.331, 225.000185 354.331, 235.630115 343.70107, 235.630115 343.70107, 246.260045 354.331, 246.260045 354.331, 256.889975 343.70107, 256.889975 343.70107, 267.519905 354.331, 267.519905 354.331, 278.149835 343.70107, 278.149835 343.70107, 288.779765 354.331, 288.779765 354.331, 299.409695 343.70107, 299.409695 343.70107, 310.039625 354.331, 310.039625 354.331, 320.669555 343.70107, 320.669555 343.70107, 337.5002775 354.331, 337.5002775 354.331, 354.331 337.5002775, 354.331 337.5002775, 343.70107 320.669555, 343.70107 320.669555, 354.331 310.039625, 354.331 310.039625, 343.70107 299.409695, 343.70107 299.409695, 354.331 288.779765, 354.331 288.779765, 343.70107 278.149835, 343.70107 278.149835, 354.331 267.519905, 354.331 267.519905, 343.70107 256.889975, 343.70107 256.889975, 354.331 246.260045, 354.331 246.260045, 343.70107 235.630115, 343.70107 235.630115, 354.331 225.000185, 354.331 225.000185, 343.70107 214.370255, 343.70107 214.370255, 354.331 203.74032499999998, 354.331 203.74032499999998, 343.70107 193.11039499999998, 343.70107 193.11039499999998, 354.331 182.48046499999998, 354.331 182.48046499999998, 343.70107 171.85053499999998, 343.70107 171.85053499999998, 354.331 161.22060499999998, 354.331 161.22060499999998, 343.70107 150.590675, 343.70107 150.590675, 354.331 139.960745, 354.331 139.960745, 343.70107 129.330815, 343.70107 129.330815, 354.331 118.700885, 354.331 118.700885, 343.70107 108.070955, 343.70107 108.070955, 354.331 97.441025, 354.331 97.441025, 343.70107 86.811095, 343.70107 86.811095, 354.331 76.181165, 354.331 76.181165, 343.70107 65.55123499999999, 343.70107 65.55123499999999, 354.331 54.921305000000004, 354.331 54.921305000000004, 343.70107 44.291375, 343.70107 44.291375, 354.331 33.661445, 354.331 33.661445, 343.70107 16.8307225, 343.70107 16.8307225, 354.331 0, 354.331 0, 337.5002775 10.62993, 337.5002775 10.62993, 320.669555 0, 320.669555 0, 310.039625 10.62993, 310.039625 10.62993, 299.409695 0, 299.409695 0, 288.779765 10.62993, 288.779765 10.62993, 278.149835 0, 278.149835 0, 267.519905 10.62993, 267.519905 10.62993, 256.889975 0, 256.889975 0, 246.260045 10.62993, 246.260045 10.62993, 235.630115 0, 235.630115 0, 225.000185 10.62993, 225.000185 10.62993, 214.370255 0, 214.370255 0, 203.74032499999998 10.62993, 203.74032499999998 10.62993, 193.11039499999998 0, 193.11039499999998 0, 182.48046499999998 10.62993, 182.48046499999998 10.62993, 171.85053499999998 0, 171.85053499999998 0, 161.22060499999998 10.62993, 161.22060499999998 10.62993, 150.590675 0, 150.590675 0, 139.960745 10.62993, 139.960745 10.62993, 129.330815 0, 129.330815 0, 118.700885 10.62993, 118.700885 10.62993, 108.070955 0, 108.070955 0, 97.441025 10.62993, 97.441025 10.62993, 86.811095 0, 86.811095 0, 76.181165 10.62993, 76.181165 10.62993, 65.55123499999999 0, 65.55123499999999 0, 54.921305000000004 10.62993, 54.921305000000004 10.62993, 44.291375 0, 44.291375 0, 33.661445 10.62993, 33.661445 10.62993, 16.8307225 0, 16.8307225 "/>
#</g>



#document.getElementById('svg')
#saveAs(new Blob([svg.contentDocument.documentElement.outerHTML], {type:"application/svg+xml"}), "name2.svg")

NS="http://www.w3.org/2000/svg"
SVG = document.createElementNS NS,"svg"

SVG.id = 'svg'

SVG.setAttribute 'version', '1.1'

SVG.setAttribute 'width', '100mm'
SVG.setAttribute 'height', '100mm'
SVG.setAttribute 'viewBox', '-10 -10 600 600'


#rect = document.createElementNS NS, 'rect'
#rect.setAttribute 'width', '30'
#rect.setAttribute 'height', '40'
#rect.style.stroke = '#00FF00'
#rect.style.strokeWidth = '1'
#rect.style.fill = 'none'
#SVG.appendChild rect
#
#polygon = document.createElementNS NS, 'polygon'
#polygon.setAttribute 'width', '30'
#polygon.setAttribute 'transform', 'translate(22.5000185, 22.5000185)'
#polygon.style.stroke = '#FF0000'
#polygon.style.strokeWidth = '1'
#polygon.style.fill = 'none'
#polygon.setAttribute 'points', '0, 0 16.8307225, 0 16.8307225, 10.62993 33.661445, 10.62993 33.661445, 0 44.291375, 0 44.291375, 10.62993 54.921305000000004, 10.62993 54.921305000000004, 0 65.55123499999999, 0 65.55123499999999, 10.62993 76.181165, 10.62993 76.181165, 0 86.811095, 0 86.811095, 10.62993 97.441025, 10.62993 97.441025, 0 108.070955, 0 108.070955, 10.62993 118.700885, 10.62993 118.700885, 0 129.330815, 0 129.330815, 10.62993 139.960745, 10.62993 139.960745, 0 150.590675, 0 150.590675, 10.62993 161.22060499999998, 10.62993 161.22060499999998, 0 171.85053499999998, 0 171.85053499999998, 10.62993 182.48046499999998, 10.62993 182.48046499999998, 0 193.11039499999998, 0 193.11039499999998, 10.62993 203.74032499999998, 10.62993 203.74032499999998, 0 214.370255, 0 214.370255, 10.62993 225.000185, 10.62993 225.000185, 0 235.630115, 0 235.630115, 10.62993 246.260045, 10.62993 246.260045, 0 256.889975, 0 256.889975, 10.62993 267.519905, 10.62993 267.519905, 0 278.149835, 0 278.149835, 10.62993 288.779765, 10.62993 288.779765, 0 299.409695, 0 299.409695, 10.62993 310.039625, 10.62993 310.039625, 0 320.669555, 0 320.669555, 10.62993 337.5002775, 10.62993 337.5002775, 0 354.331, 0 354.331, 16.8307225 343.70107, 16.8307225 343.70107, 33.661445 354.331, 33.661445 354.331, 44.291375 343.70107, 44.291375 343.70107, 54.921305000000004 354.331, 54.921305000000004 354.331, 65.55123499999999 343.70107, 65.55123499999999 343.70107, 76.181165 354.331, 76.181165 354.331, 86.811095 343.70107, 86.811095 343.70107, 97.441025 354.331, 97.441025 354.331, 108.070955 343.70107, 108.070955 343.70107, 118.700885 354.331, 118.700885 354.331, 129.330815 343.70107, 129.330815 343.70107, 139.960745 354.331, 139.960745 354.331, 150.590675 343.70107, 150.590675 343.70107, 161.22060499999998 354.331, 161.22060499999998 354.331, 171.85053499999998 343.70107, 171.85053499999998 343.70107, 182.48046499999998 354.331, 182.48046499999998 354.331, 193.11039499999998 343.70107, 193.11039499999998 343.70107, 203.74032499999998 354.331, 203.74032499999998 354.331, 214.370255 343.70107, 214.370255 343.70107, 225.000185 354.331, 225.000185 354.331, 235.630115 343.70107, 235.630115 343.70107, 246.260045 354.331, 246.260045 354.331, 256.889975 343.70107, 256.889975 343.70107, 267.519905 354.331, 267.519905 354.331, 278.149835 343.70107, 278.149835 343.70107, 288.779765 354.331, 288.779765 354.331, 299.409695 343.70107, 299.409695 343.70107, 310.039625 354.331, 310.039625 354.331, 320.669555 343.70107, 320.669555 343.70107, 337.5002775 354.331, 337.5002775 354.331, 354.331 337.5002775, 354.331 337.5002775, 343.70107 320.669555, 343.70107 320.669555, 354.331 310.039625, 354.331 310.039625, 343.70107 299.409695, 343.70107 299.409695, 354.331 288.779765, 354.331 288.779765, 343.70107 278.149835, 343.70107 278.149835, 354.331 267.519905, 354.331 267.519905, 343.70107 256.889975, 343.70107 256.889975, 354.331 246.260045, 354.331 246.260045, 343.70107 235.630115, 343.70107 235.630115, 354.331 225.000185, 354.331 225.000185, 343.70107 214.370255, 343.70107 214.370255, 354.331 203.74032499999998, 354.331 203.74032499999998, 343.70107 193.11039499999998, 343.70107 193.11039499999998, 354.331 182.48046499999998, 354.331 182.48046499999998, 343.70107 171.85053499999998, 343.70107 171.85053499999998, 354.331 161.22060499999998, 354.331 161.22060499999998, 343.70107 150.590675, 343.70107 150.590675, 354.331 139.960745, 354.331 139.960745, 343.70107 129.330815, 343.70107 129.330815, 354.331 118.700885, 354.331 118.700885, 343.70107 108.070955, 343.70107 108.070955, 354.331 97.441025, 354.331 97.441025, 343.70107 86.811095, 343.70107 86.811095, 354.331 76.181165, 354.331 76.181165, 343.70107 65.55123499999999, 343.70107 65.55123499999999, 354.331 54.921305000000004, 354.331 54.921305000000004, 343.70107 44.291375, 343.70107 44.291375, 354.331 33.661445, 354.331 33.661445, 343.70107 16.8307225, 343.70107 16.8307225, 354.331 0, 354.331 0, 337.5002775 10.62993, 337.5002775 10.62993, 320.669555 0, 320.669555 0, 310.039625 10.62993, 310.039625 10.62993, 299.409695 0, 299.409695 0, 288.779765 10.62993, 288.779765 10.62993, 278.149835 0, 278.149835 0, 267.519905 10.62993, 267.519905 10.62993, 256.889975 0, 256.889975 0, 246.260045 10.62993, 246.260045 10.62993, 235.630115 0, 235.630115 0, 225.000185 10.62993, 225.000185 10.62993, 214.370255 0, 214.370255 0, 203.74032499999998 10.62993, 203.74032499999998 10.62993, 193.11039499999998 0, 193.11039499999998 0, 182.48046499999998 10.62993, 182.48046499999998 10.62993, 171.85053499999998 0, 171.85053499999998 0, 161.22060499999998 10.62993, 161.22060499999998 10.62993, 150.590675 0, 150.590675 0, 139.960745 10.62993, 139.960745 10.62993, 129.330815 0, 129.330815 0, 118.700885 10.62993, 118.700885 10.62993, 108.070955 0, 108.070955 0, 97.441025 10.62993, 97.441025 10.62993, 86.811095 0, 86.811095 0, 76.181165 10.62993, 76.181165 10.62993, 65.55123499999999 0, 65.55123499999999 0, 54.921305000000004 10.62993, 54.921305000000004 10.62993, 44.291375 0, 44.291375 0, 33.661445 10.62993, 33.661445 10.62993, 16.8307225 0, 16.8307225'
#polygon.id = "p"
#SVG.appendChild polygon

w = 25
h = 10
spacing = 0
blocks = 22
for i in [0...blocks]
    for j in [0...blocks]
        rect = document.createElementNS NS, 'rect'

        x = (w+spacing)*i
        y = (w+spacing)*j
        ww = w
        hh = h

        overhang = (w-h)/2

        # rotate to vertical
        if (i+j)%2==1

            x += w/2 - h/2
            y -= overhang

            ww = h
            hh = w

            if j==0
                # trim top
                y += overhang
                hh -= overhang
            else if j==blocks-1
                # trim bottom
                hh -= overhang
        else

            if i==0
                # trim left
                x += overhang
                ww -= overhang
            else if i==blocks-1
                # trim right
                ww -= overhang





#        else if i == 0
#
#        if i == 0




        rect.setAttribute 'width', ww
        rect.setAttribute 'height', hh
        rect.setAttribute 'x', x
        rect.setAttribute 'y', y
        rect.style.stroke = 'black'
        rect.style.strokeWidth = '1'
        rect.style.fill = 'none'
#        rect.style.fill = if (i+j)==0 then 'red' else 'none'
        SVG.appendChild rect


document.body.appendChild SVG

# create download button

button = document.createElement 'button'
button.innerHTML = "Download"
button.style.display = 'block'
button.onclick = () ->
    saveAs(new Blob([document.getElementById('svg').outerHTML], {type:"application/svg+xml"}), "download.svg")

document.body.appendChild button



#tl = new TimelineMax()
#tl.fromTo("#p", 5, {drawSVG:"0 10"}, {drawSVG:"-10 100%", ease: Linear.easeNone})

#console.log SVG.outerHTML

# SVGObj.width.baseVal.value=w;
# SVGObj.height.baseVal.value=h;
# SVGObj.setAttribute("height",h);
# SVGObj.style.fill=fill;
# return SVGObj;


polygonLength = (poly) ->

    lastPoint = poly.points[ poly.points.length-1 ]
    dist = 0

    for p in poly.points
        dist += Math.sqrt(Math.pow((lastPoint.x - p.x), 2) + Math.pow((lastPoint.y - p.y), 2))
        lastPoint = p

    return dist

#polygonLength polygon



#length = polygonLength polygon
#
#polygon.style.transition = polygon.style.WebkitTransition = 'none'
#
#polygon.style.strokeDasharray = length + ' ' + length
#polygon.style.strokeDashoffset = length
#
## Trigger a layout so styles are calculated & the browser
## picks up the starting position before animating
#polygon.getBoundingClientRect();
## Define our transition
#speed = 500 # 1000 length per second
#time = length / speed
#console.log time + " X"
#polygon.style.transition = polygon.style.WebkitTransition = 'stroke-dashoffset '+time+'s linear'
## Go!
#polygon.style.strokeDashoffset = '0'

# distance travelled per second
ANIMATIONSPEED = 500
TRAVEL = 100 / ANIMATIONSPEED
class Rectangle

    constructor: (@element) ->

    length: () ->
        return (@element.width.baseVal.value + @element.height.baseVal.value) * 2

    animate: (delay) ->
        length = @length()

        # clear transition
        @element.style.transition = @element.style.WebkitTransition = 'none'

        # set dash length
        @element.style.strokeDasharray = length + ' ' + length
        @element.style.strokeDashoffset = length

        # tickle rendering for calculations
        @element.getBoundingClientRect()

        # transition
        time = length / ANIMATIONSPEED
        @element.style.transition = @element.style.WebkitTransition = 'stroke-dashoffset '+time+'s linear'

        # delay
        @element.style.transitionDelay = delay + 's';
        console.log "delay", delay

        # start
        @element.style.strokeDashoffset = '0'

        return time



class Polygon

    constructor: (@element) ->

    length: () ->
        lastPoint = @element.points[ @element.points.length-1 ]
        dist = 0

        for p in @element.points
            dist += Math.sqrt(Math.pow((lastPoint.x - p.x), 2) + Math.pow((lastPoint.y - p.y), 2))
            lastPoint = p

        return dist

    animate: (delay) ->
        length = @length()

        # clear transition
        @element.style.transition = @element.style.WebkitTransition = 'none'

        # set dash length
        @element.style.strokeDasharray = length + ' ' + length
        @element.style.strokeDashoffset = length

        # tickle rendering for calculations
        @element.getBoundingClientRect()

        # transition
        time = length / ANIMATIONSPEED
        @element.style.transition = @element.style.WebkitTransition = 'stroke-dashoffset '+time+'s linear'

        # delay
        @element.style.transitionDelay = delay + 's';
        console.log "delay", delay

        # start
        @element.style.strokeDashoffset = '0'

        return time





TAGTOCLASS =
    'rect': Rectangle
    'polygon': Polygon

animateSVG = (svg, delay = 0) ->
    time = delay

    for child in svg.children
        if TAGTOCLASS[child.tagName]
            element = new TAGTOCLASS[child.tagName](child)

#            console.log child.tagName, element.length()
            time += element.animate(time) + TRAVEL

#        console.warn "children", child.children.length
        time = animateSVG(child, time + TRAVEL)

    if delay == 0
        console.log time

    return time


#animateSVG document.getElementById('svg').contentDocument.documentElement
#animateSVG SVG








